{"remainingRequest":"/Users/t.j/Desktop/Projet7/P7-Groupomania-master/Frontend/node_modules/babel-loader/lib/index.js!/Users/t.j/Desktop/Projet7/P7-Groupomania-master/Frontend/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/t.j/Desktop/Projet7/P7-Groupomania-master/Frontend/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!/Users/t.j/Desktop/Projet7/P7-Groupomania-master/Frontend/src/views/Create.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/t.j/Desktop/Projet7/P7-Groupomania-master/Frontend/src/views/Create.vue","mtime":1610031143000},{"path":"/Users/t.j/Desktop/Projet7/P7-Groupomania-master/Frontend/node_modules/cache-loader/dist/cjs.js","mtime":1635943526508},{"path":"/Users/t.j/Desktop/Projet7/P7-Groupomania-master/Frontend/node_modules/babel-loader/lib/index.js","mtime":1635943529871},{"path":"/Users/t.j/Desktop/Projet7/P7-Groupomania-master/Frontend/node_modules/cache-loader/dist/cjs.js","mtime":1635943526508},{"path":"/Users/t.j/Desktop/Projet7/P7-Groupomania-master/Frontend/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js","mtime":1635943530684}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc2xpY2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIudXJsIjsKaW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsKaW1wb3J0IHJvdXRlciBmcm9tICIuLi9yb3V0ZXIiOwppbXBvcnQgIi4uL21haW4uY3NzIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJDcmVhdGUiLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBpc0FkbWluOiBmYWxzZSwKICAgICAgbmV3SW1hZ2U6ICIiLAogICAgICBjdXJyZW50VXNlcklkOiAiIiwKICAgICAgbmV3TWVzc2FnZTogIiIsCiAgICAgIGZpbGU6IG51bGwsCiAgICAgIG1lc3NhZ2VzOiBbXSwKICAgICAgaXNJbnZhbGlkOiBmYWxzZQogICAgfTsKICB9LAogIG1ldGhvZHM6IHsKICAgIGNhbGxOYW1lOiBmdW5jdGlvbiBjYWxsTmFtZSgpIHsKICAgICAgdmFyIG5hbWUgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXNlck5hbWUnKTsKICAgICAgcmV0dXJuIG5hbWUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBuYW1lLnNsaWNlKDEpOwogICAgfSwKICAgIHNlbGVjdEZpbGU6IGZ1bmN0aW9uIHNlbGVjdEZpbGUoKSB7CiAgICAgIHRoaXMuZmlsZSA9IHRoaXMuJHJlZnMuZmlsZS5maWxlc1swXTsKICAgICAgdGhpcy5uZXdJbWFnZSA9IFVSTC5jcmVhdGVPYmplY3RVUkwodGhpcy5maWxlKTsKICAgIH0sCiAgICBzZW5kOiBmdW5jdGlvbiBzZW5kKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgaWYgKCF0aGlzLmZpbGUgfHwgIWxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VyTmFtZScpIHx8ICF0aGlzLm5ld01lc3NhZ2UgfHwgdGhpcy5uZXdNZXNzYWdlID4gMTUwMCkgewogICAgICAgIHRoaXMuaXNJbnZhbGlkID0gdHJ1ZTsKICAgICAgICBjb25zb2xlLmxvZygibGlnbmUgNjkiICsgdGhpcy5maWxlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTsKICAgICAgICBmb3JtRGF0YS5hcHBlbmQoImltYWdlIiwgdGhpcy5maWxlKTsKICAgICAgICBmb3JtRGF0YS5hcHBlbmQoIlVzZXJJZCIsIGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VySWQnKSk7CiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCJtZXNzYWdlIiwgdGhpcy5uZXdNZXNzYWdlLnRvU3RyaW5nKCkpOwogICAgICAgIGF4aW9zLnBvc3QoImh0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvbWVzc2FnZXMvIiwgZm9ybURhdGEsIHsKICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgIkF1dGhvcml6YXRpb24iOiAiQmVhcmVyICIgKyBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgidG9rZW4iKQogICAgICAgICAgfQogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgX3RoaXMuVXNlcklkID0gIiI7CiAgICAgICAgICBfdGhpcy5uZXdNZXNzYWdlID0gIiI7CiAgICAgICAgICBfdGhpcy5maWxlID0gbnVsbDsKICAgICAgICAgIGFsZXJ0KCdwdWJsaWNhdGlvbiByw6l1c3NpZSEnKTsKICAgICAgICAgIHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgcGF0aDogJ1N0cmVhbScKICAgICAgICAgIH0pOwogICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["/Users/t.j/Desktop/Projet7/P7-Groupomania-master/Frontend/src/views/Create.vue"],"names":[],"mappings":";;;;;;AAuCA,OAAO,KAAP,MAAkB,OAAlB;AACA,OAAO,MAAP,MAAmB,WAAnB;AACA,OAAO,aAAP;AAEA,eAAe;AACX,EAAA,IAAI,EAAE,QADK;AAEV,EAAA,IAFU,kBAEH;AACJ,WAAO;AACH,MAAA,OAAO,EAAE,KADN;AAEH,MAAA,QAAQ,EAAE,EAFP;AAGH,MAAA,aAAa,EAAE,EAHZ;AAIH,MAAA,UAAU,EAAE,EAJT;AAKH,MAAA,IAAI,EAAE,IALH;AAMH,MAAA,QAAQ,EAAE,EANP;AAOH,MAAA,SAAS,EAAE;AAPR,KAAP;AASH,GAZU;AAaX,EAAA,OAAO,EAAE;AACL,IAAA,QADK,sBACM;AACP,UAAI,IAAG,GAAI,YAAY,CAAC,OAAb,CAAqB,UAArB,CAAX;AACA,aAAO,IAAI,CAAC,MAAL,CAAY,CAAZ,EAAe,WAAf,KAA+B,IAAI,CAAC,KAAL,CAAW,CAAX,CAAtC;AACH,KAJI;AAKL,IAAA,UALK,wBAKQ;AACT,WAAK,IAAL,GAAY,KAAK,KAAL,CAAW,IAAX,CAAgB,KAAhB,CAAsB,CAAtB,CAAZ;AACA,WAAK,QAAL,GAAgB,GAAG,CAAC,eAAJ,CAAoB,KAAK,IAAzB,CAAhB;AACH,KARI;AASL,IAAA,IATK,kBASE;AAAA;;AACH,UAAK,CAAC,KAAK,IAAN,IAAc,CAAC,YAAY,CAAC,OAAb,CAAqB,UAArB,CAAf,IAAmD,CAAC,KAAK,UAAzD,IAAuE,KAAK,UAAL,GAAkB,IAA9F,EAAqG;AAC7F,aAAK,SAAL,GAAiB,IAAjB;AAEA,QAAA,OAAO,CAAC,GAAR,CAAY,aAAa,KAAK,IAA9B;AACR,OAJA,MAIO;AACH,YAAM,QAAO,GAAI,IAAI,QAAJ,EAAjB;AACA,QAAA,QAAQ,CAAC,MAAT,CAAgB,OAAhB,EAAyB,KAAK,IAA9B;AACA,QAAA,QAAQ,CAAC,MAAT,CAAgB,QAAhB,EAA0B,YAAY,CAAC,OAAb,CAAqB,QAArB,CAA1B;AACA,QAAA,QAAQ,CAAC,MAAT,CAAgB,SAAhB,EAA2B,KAAK,UAAL,CAAgB,QAAhB,EAA3B;AACA,QAAA,KAAK,CAAC,IAAN,CAAW,qCAAX,EAAkD,QAAlD,EAA4D;AAAE,UAAA,OAAO,EAAE;AAAE,6BAAgB,YAAY,YAAY,CAAC,OAAb,CAAqB,OAArB;AAA9B;AAAX,SAA5D,EACC,IADD,CACM,YAAK;AACP,UAAA,KAAI,CAAC,MAAL,GAAc,EAAd;AACA,UAAA,KAAI,CAAC,UAAL,GAAkB,EAAlB;AACA,UAAA,KAAI,CAAC,IAAL,GAAY,IAAZ;AACA,UAAA,KAAK,CAAC,sBAAD,CAAL;AACA,UAAA,MAAM,CAAC,IAAP,CAAY;AAAC,YAAA,IAAG,EAAI;AAAR,WAAZ;AACH,SAPD,EAQC,KARD,CAQO,UAAC,KAAD,EAAS;AACZ,UAAA,OAAO,CAAC,GAAR,CAAY,KAAZ;AACH,SAVD;AAWJ;AACJ;AA/BK;AAbE,CAAf","sourcesContent":["  <template>\n    <main class=\"container\"> \n        <!-- Un seul bloc pour le contenu creation message -->\n        <section class=\"row card bg-light m-5 p-3\">\n            <form enctype=\"multipart/form-data\">\n                <div class=\"header p-1\">\n                    <h1  class=\"btn btn-dark\" style=\"cursor:default\">\n                        {{ callName() }} vous allez créer une nouvelle publication    <img src=\"../assets/send.svg\" class=\"m-1\" alt=\"send\" style=\"width:1rem\"/>  \n                    </h1>\n                </div>\n                <div class=\"row\">\n                    <div class=\"col-12 justify-content-center form-group\">\n                        <label for=\"newMessage\">Donnez des détails sur votre publication.</label>\n                        <textarea v-on:keydown=\"isInvalid = false\" class=\"form-control\" v-model=\"newMessage\" id=\"newMessage\" name=\"message\" rows=\"8\" placeholder=\"Saisissez votre message. (1500 caractères max)\"></textarea>\n                    </div>\n                    <div class=\"col-12 justify-content-center text-center\">\n                        <img :src=\"newImage\" class=\"w-50 rounded\">\n                        <p class=\"text-center\"> un aperçu de votre post apparaîtra ici. Formats acceptés: jpg, jpeg, png et gif.</p>\n                    </div>\n                    <div class=\"col-12 justify-content-center\">\n                        <div class=\"form-group justify-content-center\">\n                            <label for=\"File\">Choisir une nouvelle photo</label>\n                            <input @change=\"selectFile()\" type=\"file\" ref=\"file\" name=\"image\" class=\"form-control-file\" id=\"File\" accept=\".jpg, .jpeg, .gif, .png\">\n                        </div>\n                    </div>\n                </div>\n                <div class=\"footer col-10 mx-auto align-content-center\">\n                    <div><button type=\"submit\" @click.prevent=\"send()\" class=\"btn btn-dark btn-block m-2 p-2\">Valider</button></div>\n                    <router-link to=\"/Stream\"> <div> <a class=\"btn btn-danger btn-block m-2 p-2\">Annuler/Retour</a></div></router-link> \n                </div>\n                 <div v-show=\"isInvalid\" class=\"invalidBox m-2\" key=\"invalid\">\n                    <p>Vous ne pouvez pas envoyer de post sans contenu (vous devez inclure texte et image). Votre message doit faire moins de 1500 caractères.</p>        \n                </div>  \n            </form>\n        </section>\n    </main>\n</template>\n\n<script>\nimport axios from \"axios\"\nimport router from \"../router\";\nimport \"../main.css\";\n\nexport default {\n    name: \"Create\",\n     data() {\n        return {\n            isAdmin: false,\n            newImage: \"\",\n            currentUserId: \"\", \n            newMessage: \"\",\n            file: null,\n            messages: [],\n            isInvalid: false\n        }\n    },\n    methods: {\n        callName() {\n            let name = localStorage.getItem('userName');\n            return name.charAt(0).toUpperCase() + name.slice(1);\n        },\n        selectFile() {\n            this.file = this.$refs.file.files[0];\n            this.newImage = URL.createObjectURL(this.file)\n        },\n        send() {\n            if ( !this.file || !localStorage.getItem('userName') || !this.newMessage || this.newMessage > 1500 ) {\n                    this.isInvalid = true;\n\n                    console.log(\"ligne 69\" + this.file)\n            } else {\n                const formData = new FormData()\n                formData.append(\"image\", this.file)\n                formData.append(\"UserId\", localStorage.getItem('userId'))\n                formData.append(\"message\", this.newMessage.toString())\n                axios.post(\"http://localhost:3000/api/messages/\", formData, { headers: { \"Authorization\":\"Bearer \" + localStorage.getItem(\"token\")}})\n                .then(()=> {\n                    this.UserId = \"\"\n                    this.newMessage = \"\"\n                    this.file = null\n                    alert('publication réussie!')\n                    router.push({path : 'Stream'})\n                })\n                .catch((error)=>{\n                    console.log(error);\n                })\n            }\n        }\n    }\n}\n</script>"],"sourceRoot":""}]}